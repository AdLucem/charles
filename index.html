<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-GB" xml:lang="en-GB" xmlns="http://www.w3.org/1999/xhtml" data-ng-app="frankenbratApp">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Frankenbrat</title>

  <!-- AngularJS -->
  <script src="/lib/angular.min.js"></script>
  <script src="/lib/ui-bootstrap-tpls-0.12.1.min.js"></script>

  <!-- Firebase -->
  <script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
  <!-- AngularFire -->
  <script src="https://cdn.firebase.com/libs/angularfire/1.1.1/angularfire.min.js"></script>

  <link rel="stylesheet" href="/lib/bootstrap.min.css">
  <link rel="stylesheet" href="/lib/bootstrap-theme.min.css">
  <link rel="stylesheet" type="text/css" href="css/brat-style.css" />
  <link rel="stylesheet" type="text/css" href="css/style.css" />
  <link rel="stylesheet" type="text/css" href="css/style-vis.css" />
  <link rel="stylesheet" type="text/css" href="css/jquery-theme/jquery-ui-redmond.css" />
  
  <script type="text/javascript">
    // Returns the value of a URL variable. (If it doesn't exist, then it returns null.)
    function getQueryVariable(variable) {
      var query = window.location.search.substring(1);
      var vars = query.split("&");
      for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split("=");
        if (pair[0] == variable) {
          return pair[1];
        }
      }
      return null;
    }
  </script>

  <script type="text/javascript" src="head.load.min.js"></script>
  <script type="text/javascript" src="lib/spin.min.js"></script>
  <script type="text/javascript" src="js/app.js"></script>
  <script type="text/javascript" src="js/fb.js"></script>
  <script type="text/javascript" src="js/controllers/mainController.js"></script>
  <script type="text/javascript" src="js/controllers/spinnerController.js"></script>
  <script type="text/javascript" src="js/controllers/docSelectorController.js"></script>
  <script type="text/javascript" src="js/controllers/showController.js"></script>
  <script type="text/javascript" src="js/controllers/deleteTagController.js"></script>
  <script type="text/javascript" src="js/controllers/bratController.js"></script>
  <script type="text/javascript" src="js/controllers/tagController.js"></script>
  <script type="text/javascript" src="js/controllers/navigationController.js"></script>
  <script type="text/javascript" src="js/controllers/logController.js"></script>
  <script type="text/javascript" src="js/lib/json2.js"></script>
</head>

<body>

  <div class="connection-failed" ng-controller="mainController as mainCtrl">
    <div class="alert alert-danger" role="alert" style="height: 100vh;" ng-if="!mainCtrl.connectedToFirebase()">
      <h1>Connection to Firebase Failed</h1>
      <p>
        Check that the <span id="code">FB</span> instance exists and its
        <span id="code">link</span> property is properly set.
      </p>
    </div><!-- alert -->
    
    <div id="main" class="container" ng-if="mainCtrl.connectedToFirebase()">
      <div class="row">
        <div id="content" class="col-sm-7">
          <div>
            <h1 style="text-align:center">Welcome to Frankenbrat!</h1>
          </div>
          
          <div>
            <h3 style="text-align:center">Resolve the aliases to characters in these passages from <i>Pride and Prejudice</i></h3>
          </div>
          
          <div id="spinner" ng-controller="spinnerController"></div>
          
          <style type="text/css">
            @import url("//netdna.bootstrapcdn.com/bootstrap/3.0.0-rc2/css/bootstrap-glyphicons.css");
          </style>
          
          <script type="text/ng-template" id="docSelectorModalContent.html">
            <div class="modal-header">
              <h3 class="modal-title">Select a Document</h3>
            </div>
            <div class="modal-body">
              <div ng-repeat="nameIndex in docNameIndexData">
                <a ng-click="selected.nameIndex = nameIndex">{{ nameIndex.name }}</a>
              </div>
              <p style="margin-top: 5px;">Go to <b>{{ selected.nameIndex.name }}</b></p>
            </div>
            <div class="modal-footer">
              <button class="btn btn-primary" ng-click="ok()">Go</button>
              <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
            </div>
          </script>
          
          <div style="margin: 15px auto 5px;" ng-controller="navigationController">
            <center>
              <div style="margin-bottom:40px">
                <button type="button" class="btn btn-default btn-lg" ng-click="selectDoc()"><strong>Select Document</strong></button>
              </div>
              
              <button type="button" class="btn btn-default btn-lg" ng-click="previousDoc()" ng-disabled="docIndex <= 0">
                <span class="glyphicon glyphicon-arrow-left"></span> &nbsp; Prev
              </button>
              <!--<p style="display: inline;margin: 0 30px;padding-top: 10px;font-size:20px;font-weight:bold;">{{(docIndex + 1) + ' of ' + numDocuments}}</p>-->
              <p style="display: inline;margin: 0 30px;padding-top: 10px;font-size:20px;font-weight:bold;">{{docData.name}}</p>
              <button type="button" class="btn btn-default btn-lg" ng-click="nextDoc()" ng-disabled="docIndex >= numDocuments - 1">
                Next &nbsp; <span class="glyphicon glyphicon-arrow-right"></span>
              </button>
            </center>
          </div>
          
          <style type="text/css">
            text {
              font-size: 15px;
            }
            .span text {
              font-size: 10px;
            }
            .arcs text {
              font-size: 9px;
            }
          </style>
  
          <script type="text/javascript">
            var bratLocation = 'lib/brat/';
  
            head.js(
              // External libraries.
              bratLocation + '/client/lib/jquery.min.js',
              bratLocation + '/client/lib/jquery.svg.min.js',
              bratLocation + '/client/lib/jquery.svgdom.min.js',
  
              // brat helper modules.
              bratLocation + '/client/src/configuration.js',
              bratLocation + '/client/src/util.js',
              bratLocation + '/client/src/annotation_log.js',
              bratLocation + '/client/lib/webfont.js',
              
              // brat modules.
              bratLocation + '/client/src/dispatcher.js',
              bratLocation + '/client/src/url_monitor.js',
              bratLocation + '/client/src/visualizer.js'
            );
  
            var webFontURLs = [
              bratLocation + '/static/fonts/Astloch-Bold.ttf',
              bratLocation + '/static/fonts/PT_Sans-Caption-Web-Regular.ttf',
              bratLocation + '/static/fonts/Liberation_Sans-Regular.ttf'
            ];
          </script>
          
          <div id="brat-view" ng-controller="bratController" ng-click="select($event)"></div>
        </div>
  
  <div class="col-sm-4">
    <div class="panel panel-primary" style="height: 100%;margin: 10px;position: fixed;">
      <div class="panel-heading">
        <h3>Character Annotation Panel</h3>
      </div>
  
      <div class="panel-body" ng-controller="tagController">
  
        <script type="text/ng-template" id="showModalContent.html">
          <div class="modal-header">
            <h3 class="modal-title">Instances of '{{ tag.type }}'</h3>
          </div>
          <div class="modal-body">
            <div>
              <carousel interval="myInterval">
                <slide ng-repeat="slide in slides" active="slide.active">
                  <!-- <img ng-src="{{slide.image}}" style="margin:auto;"> -->
                  <div class="carousel-caption" style="position:relative;color:black;margin:auto;right:0;left:0;width:600px">
                    <h4>{{ slide.docName }}</h4>
                    <p>
                      ...{{ slide.pretext }} &nbsp;&nbsp;&nbsp;
                      <span style="color: red;font-weight: bold;">{{ slide.span }}</span> &nbsp;&nbsp;&nbsp; {{ slide.posttext }}...
                    </p>
                  </div>
                </slide>
              </carousel>
            </div>
  
          </div>
          <div class="modal-footer">
            <button class="btn btn-default" ng-click="close()">Close</button>
          </div>
        </script>
  
        <script type="text/ng-template" id="deleteTagModalContent.html">
          <div class="modal-header">
            <h3 class="modal-title">Choose a Replacement Character</h3>
          </div>
          <div class="modal-body">
            <div ng-repeat="item in items">
              <a ng-click="selected.item = item">{{ item.type }}</a>
            </div>
            <p style="margin-top: 5px;">Replace with <b>{{ selected.item.type }}</b></p>
          </div>
          <div class="modal-footer">
            <button class="btn btn-danger" ng-click="ok()">DELETE</button>
            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
          </div>
              </script>
              
              <div class="well well-sm">
                <p align="center" style="font-size:12px">SELECTED:</p>
                <p align="center" style="font-size:18px" ng-show="visualElement" ng-hide="!visualElement">
                  <b>{{ span }}</b>
                </p>
                <p align="center" style="font-size:18px" ng-show="!visualElement" ng-hide="visualElement">
                  <b>NONE</b>
                </p>
                
                <div style="margin-bottom: 5px; overflow: hidden;" ng-repeat="item in collData.entity_types">
                  <label ng-show="item.type != 'ALIAS' && (item.type == 'NON-CHARACTER' || item.type == 'UNRESOLVED')">
                    <div style="float:left">
                      <button class="btn btn-default" ng-click="tag(item)" ng-disabled="!visualElement">{{ item.type }}</button>
                    </div>
                  </label>
  
                  <div style="float:right" ng-show="item.type == 'NON-CHARACTER' || item.type == 'UNRESOLVED'">
                    <button class="btn btn-success" ng-click="tagOnTop(item)" ng-disabled="!visualElement">+</button>
                  </div>
                </div>
                
                <div ng-show="collData.entity_types.length > 3" class="pre-scrollable" style="border: 2px solid #AAA; border-radius: 5px; padding: 5px; max-height: 250px;">
                  <div style="overflow:hidden" ng-repeat="item in collData.entity_types | tagOrderFilter">
                    <label ng-show="item.type != 'ALIAS' && item.type != 'NON-CHARACTER' && item.type != 'UNRESOLVED'">
                      <div style="float:left">
                        <button class="btn btn-default" ng-click="tag(item)" ng-disabled="!visualElement">{{ item.type }}</button>
                      </div>
                    </label>
  
                    <div style="float:right" ng-if="item.type != 'ALIAS' && item.type != 'NON-CHARACTER' && item.type != 'UNRESOLVED'">
                      <button class="btn btn-danger" ng-click="removeTag(item)" ng-disabled="!visualElement">X</button>
                    </div>
  
                    <div style="float:right" ng-show="item.type != 'ALIAS' && item.type != 'NON-CHARACTER' && item.type != 'UNRESOLVED'">
                      <button class="btn btn-success" ng-click="tagOnTop(item)" ng-disabled="!visualElement">+</button>
                    </div>
  
                    <div style="float:right" ng-show="item.type != 'ALIAS' && item.type != 'NON-CHARACTER' && item.type != 'UNRESOLVED'">
                      <button class="btn btn-info" ng-click="showEntities(item)" ng-disabled="!visualElement"><></button>
                    </div>
                  </div>
                </div>
                <div style="text-align: center;">
                  <button class="btn btn-info" style="font-size: 15px;margin: 10px auto;" ng-click="addNewTag()" ng-disabled="!visualElement">NEW</button>
                  <button class="btn btn-warning" ng-click="untag()" ng-disabled="!visualElement">Untag</button>
                </div>
              </div>
  
  
              <div class="panel-footer bg-info">
                <p align="center" style="color: blue;font-size: 15px;margin: 10px auto;">ALIAS's Remaining: <b>{{aliasesRemaining}}</b>
                </p>
              </div>
            </div>
            
            <h3 align="center">Log</h3>
            
            <div class="well well-sm" ng-controller="logController" style="width:300px;margin:auto">
                <div class="pre-scrollable" style="height:100px">
                  <div style="overflow:hidden">
               <ul style="list-style-type: none;">
        <li style="margin: 15px 0;" ng-repeat="message in messages">{{ message.text }}</li>
      </ul></div
          <!-- push a new message onto the array -->
      </div>
          <form ng-submit="addMessage()">
        <input ng-model="newMessageText" />
        <button type="submit">Add Entry</button>
      </form>
            </div>
          </div>
        </div>
  
      </div>
    </div>
  </div>

</body>

</html>
